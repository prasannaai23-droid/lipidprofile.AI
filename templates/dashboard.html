<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dashboard</title>
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
  <div class="container">
    <h1>Dashboard â€” {{ patient_id }}</h1>

    {% if risk == "no-data" %}
      <p>No data yet for this patient. <a href="/">Submit</a> or <a href="/upload">upload report</a>.</p>
    {% else %}
      <p><strong>Recorded:</strong> {{ created_at }}</p>
      <p><strong>LDL:</strong> {{ ldl }} mg/dL</p>
      <p><strong>HDL:</strong> {{ hdl }} mg/dL</p>
      <p><strong>Triglycerides:</strong> {{ trig }} mg/dL</p>
      <p><strong>Risk:</strong> <span class="risk {{ risk }}">{{ risk.upper() }}</span></p>

      <!-- Add chart section -->
      <h3>Lipid Profile Chart</h3>
      <canvas id="lipidChart" width="400" height="200"></canvas>

      <h3>Daily Plan</h3>
      <ul>
        {% for m in plan.meals %}<li>{{ m }}</li>{% endfor %}
      </ul>

      <h3>Exercise</h3>
      <ul>
        {% for e in plan.exercise %}<li>{{ e }}</li>{% endfor %}
      </ul>

      <h3>Reminders</h3>
      <ul>
        {% for r in plan.reminders %}<li>{{ r }}</li>{% endfor %}
      </ul>

      <h3>Raw OCR Text</h3>
      <pre>{{ raw_text }}</pre>
    {% endif %}
  </div>

  <!-- Chart.js Script -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('lipidChart').getContext('2d');
    const lipidChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['LDL', 'HDL', 'Triglycerides'],
        datasets: [{
          label: 'mg/dL',
          data: [{{ ldl }}, {{ hdl }}, {{ trig }}],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });
  </script>
</body>
</html>